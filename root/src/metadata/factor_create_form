<form action="/metadata/factor/add" 
      method="post" 
      onsubmit=" new Ajax.Updater( 'new_factor_messages',  
                                   '/metadata/factor/add', 
                                   { 
                                     parameters: Form.serialize(this),
                                     asynchronous: 1, 
                                     onComplete: function(){
                                                  setTimeout(
                                                    function(){
                                                      update_factor_list('factor_list');
                                                    }, 
                                                    1000
                                                  );
                                                }
                                   } 
                                 ) ; return false"
>

  <fieldset>
    <legend>Add a new factor</legend>

    <div id="new_factor_messages"></div>

      <div class="labelled_input">
        <label for="factor_name">Name</label>
        <input type="text" name="factor_name"/>
      </div> 

      <div class="labelled_input">
        <label for="factor_description">Description</label>
        <textarea name="factor_description"></textarea>
      </div>

      [%IF Catalyst.check_user_roles('admin')%]
        <div class="labelled_input">
          <label for="factor_owner">Owner</label>
          <input type="text" name="factor_owner" id="factor_owner" value="[%Catalyst.user.username%]"/>
          <div id="factor_owner_autocomplete_choices" class="autocomplete"></div>
          <script type="text/javascript" language="javascript">
          // <![CDATA[
               new Ajax.Autocompleter("factor_owner","factor_owner_autocomplete_choices","/metadata/owner_autocomplete",{});
          // ]]>
          </script>
        </div>
      [%ELSE%]
         <input type="hidden" name="factor_owner" id="factor_owner" value="[%Catalyst.user.username%]"/>
      [%END%]

      <br/><input type="submit" name="submit" value="add factor" class="button"/>
     
   
  </fieldset>
</form>

