\subsubsection{Users}
\label{sec:users}

\paragraph{}
Users are represented in the database in the \texttt{person} table. The primary key is the username. As well as self-explanatory fields like \texttt{forename}, \texttt{surname}, \texttt{email}, the \texttt{experiment\_name} and \texttt{experiment\_owner} fields are references to the \texttt{experiment} table and represent the user's currently active experiment. Similarly, a user's currently selected datafiles are held in the \texttt{person\_datafile} table.

\paragraph{}
Authentication (verifying that the user is indeed who they claim to be) is implemented using passwords, stored in the database using one-way (SHA1) encryption. Authorization (verifying that an authenticated user has access rights to a given part of the application) is implemented using roles. Available roles a user may have are stored in the \texttt{role} table and the many-to-many relationship between roles and users is modelled in the \texttt{person\_role} mapping table. Currently the only important roles are \texttt{admin} and \texttt{dev}. For a normal user, ROME controls access such that they cannot edit, or in some cases even view, other user's experiments. Typically a user with the \texttt{admin} role will be allowed to bypass these access controls. There are also various administration pages to which only users with the \texttt{admin} role are granted access. Users with the \texttt{dev} role are granted access to the component development tools in the Devel controller, if installed. Users also have a second layer of authorization that determine's their access rights to specific experiments and  datafiles. This is discussed in more detail in the following section.

\paragraph{}
Users have Experiments, which have Datafiles. These are discussed in more detail in sections  \ref{sec:experiments} and  \ref{sec:datafiles}. As datafiles could potentially be very large, they will be more efficiently dealt with by the filesystem than the database, so they are stored as normal files and only their location is held in the database. When a new user is registered, two directories are created: A data directory for their datafiles and a static directory for any downloadable data. The location of the data directory is specified by the userdata entry in the \texttt{rome.yml} config file. Users are given a directory under this location named with their username. A subdirectory called uploads is also created, into which they can upload raw data. This will be discussed in more detail in section \ref{sec:uploads}. The static directories are created under \texttt{root/rome/static/user}. If a user is deleted, their data directories are also deleted. As shared experiments and datafiles cannot be deleted, a user account cannot be deleted if they

This includes any content which may have been shared with a workgroup or made public, though users can hand ownership of such files over to another user before deleting their account if they wish.


