\subsection{Data Parsers}
\label{sec:parsers}

\paragraph{}
Parsing is the process of turning data from one format to another. In the specific context of ROME, this means the process of turning uploaded files into an .RData file which will serve as the root datafile for an experiment. Datafiles cannot exist outside of an experiment, so parsing takes place in the context of the currently selected experiment. An experiment may only have a single root datafile. If a root datafile already exists, the user will be warned and given the option to delete it, taking with it all other datafiles in the experiment.

\paragraph*{}
The core controller responsible for parsing data is \texttt{lib/ROME/Controller/Parser/Base.pm}. This doesn't actually contain any code for parsing data, that is left to its subclasses. It does contain the global \verb|parse| action, which checks what parses you have installed (anything in the \texttt{ROME::Controller::Parser::*} namespace, other than Base) and passes them to the template defined in \texttt{root/src/parse/form.tt2}. This template defines a form with a select input from which the user can choose the appropriate parser for the data they are using. 

\paragraph*{}
The select parser form submits via an AJAX call to the \texttt{list\_files} action in the Parser::Base controller. This sets the selected parser for the session then returns a second form comprising checkboxes for each of the files in the current user's upload directory which that parser is capable of processing. 

\paragraph*{}
The file select form submits to the parse action again. When there are files selected, rather than simply returning the form, the parse action forwards to its \texttt{parse\_files} action, which runs some validation tests on the filenames, then forwards to the \texttt{\_parse\_files} action in the currently selected parser subclass. This action creates an R process to generate the root datafile.

