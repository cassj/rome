\subsubsection{Datafiles}
\label{sec:datafiles}

\paragraph{}
Basic information about datafiles is stored in the \texttt{datafile} table. This table has a three-element primary key made up of \texttt{name} (of the datafile) and the two-element primary key of the experiment table, \texttt{experiment\_name} and \texttt{experiment\_owner}, reflecting the fact that a datafile name need only be unique to a given experiment. Other fields are an optional \texttt{description}, the \texttt{job\_id} of the job which generated the datafile (a foreign key to the \texttt{job} table), the full \texttt{path} to the datafile, its \texttt{datatype} (a foreign key to the \texttt{datatype} table), and its \texttt{status}. 

% \paragraph{}
% Datafiles are generated by processes (see section \ref{sec:processes}). Information about processes is stored in the \texttt{process} table and the \texttt{datafile} table has a \texttt{process} entry to link it to the process which was used in its generation. Processes also have associated parameters and the \texttt{datafile\_parameter} table stores the actual parameter values used as input to the process. The \texttt{datafile\_relationship} table holds information about the parent-child relationship between datafile(s). Each process requires a specified number of datafiles of specified types to run and these become the parents of the datafile(s) produced by the process. Typically all of the parent files should be involved in generating all of the  output datafiles. If a process is using different sets of input to generate multiple output files it should be broken into seperate processes.

% \paragraph{}
% When a process is queued to run, it generates placeholder datafiles for its output. These are simply empty datafiles with associated datatypes and they are marked as pending by an entry in the \texttt{datafile\_pending} table. As processes can take a long time to run, pending datafiles allow the user to queue downstream processes before the datafiles are generated. The queuing system is smart enough to ensure that a process is not run if any of its input datafiles are still pending.

\paragraph{}
Datafiles are always owned by the owner of the experiment to which they belong. Ownership of an experiment can be handed to another user if required. If a user has shared access to an experiment, meaning they can view it but not edit it, they can make a copy of the whole experiment if they need write access. Upon creation, the status of a datafile is set to private. Datafiles can be shared with other users by setting the status to shared or public. A public datafile is viewable by anyone whereas a shared datafile is viewable only by members of the workgroups with which it has been shared (defined in the datafile\_workgroup table).
%  The users can manage their datafiles via the Datafiles page under the Session menu (by default, though menu structures can be changed by administrators if they wish). 

\paragraph{}
There are three extensions to the basic datafile: image files, export files and report files. Export files are the results of exporting datafiles to a different format. Export files are not available for further processing. Image files can be generated by a job, and may be of various file types but are most commonly PNG (portable network graphics). Image files are not available for further processing. Report files may be generated from PNG image files and txt export files, as well as user-input text. 
